ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
packages <- c("GGally", "readxl", "rgdal", "rgeos", "sp", "spatstat", "tidyverse", "dismo", "MASS", "ggplot2", "plyr", "maps", "maptools", "raster", "geostatsp", "patchwork")
ipak(packages)
setwd("C:/Users/Mikel/Documents/Curso_2020-2021/Articulo_Monforte_QI/Github/patterns_monforte/shp")
locations <- readOGR(dsn="locations.shp", layer="locations")
setwd("C:/Users/Mikel/Documents/Curso_2020-2021/Articulo_Monforte_QI/Github/patterns_monforte/grids")
knitr::opts_chunk$set(eval = FALSE,
echo = TRUE)
# Import variables and set the same extent for everyone
elevation <- raster("dem_monforte.tif")
elevation <- raster("dem_monforte.tif")
tot_ins <- raster("total_insolation_monforte.asc")
tot_inso <- projectRaster(tot_ins, elevation)
asp <- raster("aspect_monforte.tif")
aspect <- projectRaster(asp, elevation)
slop <- raster("slope_monforte.tif")
slope <- projectRaster(slop, elevation)
vis_prom <- raster("visual_prominence_monforte.tif")
visual_prom <- projectRaster(vis_prom, elevation)
tpi100_monf <- raster("tpi100_monforte.asc")
tpi100 <- projectRaster(tpi100_monf, elevation)
wind_monf <- raster("wind_monforte.asc")
wind <- projectRaster(wind_monf, elevation)
wetland_c <- raster("wetland_cost_monforte.tiff")
wetland_cost <- projectRaster(wetland_c, elevation)
goat_c <- raster("goat_cost_monforte.tiff")
goat_cost <- projectRaster(goat_c, elevation)
geol_c <- raster("geology_cost_monforte.tiff")
geol_cost <- projectRaster(geol_c, elevation)
hydro_c <- raster("hydrology_cost_monforte.tiff")
hydro_cost <- projectRaster(hydro_c, elevation)
lcp_c <- raster("lcp_cost_monforte.tiff")
lcp_cost <- projectRaster(lcp_c, elevation)
covariates <- stack(elevation, tot_inso, aspect, slope, visual_prom, tpi100, wetland_cost, geol_cost, hydro_cost, lcp_cost, wind, tpi500)
covariates <- stack(elevation, tot_inso, aspect, slope, visual_prom, tpi100, wetland_cost, geol_cost, hydro_cost, lcp_cost, wind)
names(covariates) <- c("elevation", "tot_inso", "aspect", "slope", "visual_prom", "tpi100", "wetland_cost", "geol_cost","hydro_cost", "lcp_cost", "wind", "tpi500")
names(covariates) <- c("elevation", "tot_inso", "aspect", "slope", "visual_prom", "tpi100", "wetland_cost", "geol_cost","hydro_cost", "lcp_cost", "wind")
locvals <- data.frame(extract(covariates, locations))
locvals$site <- locations$CID==1
mod <- glm(site~elevation+tot_inso+aspect+slope+visual_prom+tpi100+wetland_cost+geol_cost+hydro_cost+lcp_cost+wind, data=locvals, family=binomial(logit))
summary(mod)
mod2 <- stepAIC(mod)
mod2$anova
summary(mod2)
logodds <- 7.2294176+(elevation* -0.0167014)+(slope*-0.3456405)+(visual_prom*0.0458370)+(wetland_cost*-0.0017355)+(hydro_cost*0.0007585)
par(mfrow=c(1,1))
plot(logodds)
logodds <- 7.2294176+(elevation* -0.0167014)+(slope*-0.3456405)+(visual_prom*0.0458370)
par(mfrow=c(1,1))
plot(logodds)
relprob <- (exp(logodds))/(1+(exp(logodds)))
par(mfrow=c(1,1))
plot(relprob, col=terrain.colors(8, alpha=1), legend=TRUE, axes=TRUE, main="GLM Monforte")
points(locations[locations$CID==1,], pch=19, cex=0.3, col="red")
library(vioplot)
tinytex::install_tinytex()
